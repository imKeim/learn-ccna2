## Топология

![topology](./assets/topology.png)

## Таблица адресации

| Устройство | Интерфейс   | IP-адрес | Маска подсети   | Шлюз по умолчанию |
|------------|-------------|----------|-----------------|-------------------|
| R1         | G0/0/0      | 10.0.0.1 | 255.255.255.252 | —                 |
| R1         | G0/0/1      | —        | —               | —                 |
| R1         | G0/0/1.100  |          |                 | —                 |
| R1         | G0/0/1.200  |          |                 | —                 |
| R1         | G0/0/1.1000 | —        | —               | —                 |
| R2         | G0/0        | 10.0.0.2 | 255.255.255.252 | —                 |
| R2         | G0/0/1      |          |                 | —                 |
| S1         | VLAN 200    |          |                 |                   |
| S2         | VLAN 1      |          |                 |                   |
| PC-A       | NIC         | DHCP     | DHCP            | DHCP              |
| PC-B       | NIC         | DHCP     | DHCP            | DHCP              |

## Таблица VLAN

| VLAN | Имя         | Назначенный интерфейс       |
|------|-------------|-----------------------------|
| 1    | Нет         | S2: F0/18                   |
| 100  | Клиенты     | S1: F0/6                    |
| 200  | Управление  | S1: VLAN 200                |
| 999  | Parking_Lot | S1: F0/1-4, F0/7-24, G0/1-2 |
| 1000 | Собственная | —                           |

## Задачи

Часть 1. Создание сети и настройка основных параметров устройства

Часть 2. Настройка и проверка двух серверов DHCPv4 на R1

Часть 3. Настройка и проверка DHCP-ретрансляции на R2

## Общие сведения/сценарий

Протокол динамической конфигурации сетевого узла (DHCP) — сетевой протокол, позволяющий сетевым администраторам управлять и автоматизировать назначение IP-адресов. Без использования DHCP для IPv4 администратору необходимо вручную назначать и настраивать IP-адреса, предпочтительные DNS-серверы и шлюзы по умолчанию. По мере увеличения сети и перемещении устройств из одной внутренней сети в другую это становится административной проблемой.

В предложенном сценарии размеры компании увеличились, и сетевые администраторы больше не имеют возможности назначать IP-адреса для устройств вручную. Ваша задача заключается в настройке маршрутизатора R2 для назначения IPv4-адресов в двух разных подсетях.

**Примечание**: Маршрутизаторы, используемые в практических лабораторных работах CCNA, - это Cisco 4221 с Cisco IOS XE Release 16.9.4 (образ universalk9). В лабораторных работах используются коммутаторы Cisco Catalyst 2960 с Cisco IOS версии 15.2(2) (образ lanbasek9). Можно использовать другие маршрутизаторы, коммутаторы и версии Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах. Правильные идентификаторы интерфейса см. в сводной таблице по интерфейсам маршрутизаторов в конце лабораторной работы.

**Примечание.** Убедитесь, что у всех маршрутизаторов и коммутаторов была удалена начальная конфигурация. Если вы не уверены в этом, обратитесь к инструктору.

## Необходимые ресурсы

-   2 маршрутизатора (Cisco 4221 с универсальным образом Cisco IOS XE версии 16.9.4 или аналогичным)
-   2 коммутатора (Cisco 2960 с операционной системой Cisco IOS 15.2(2) (образ lanbasek9) или аналогичная модель)
-   2 ПК (ОС Windows с программой эмуляции терминалов, такой как Tera Term)
-   Консольные кабели для настройки устройств Cisco IOS через консольные порты.
-   Кабели Ethernet, расположенные в соответствии с топологией

## Инструкции

### Часть 1. Создание сети и настройка основных параметров устройства

В первой части лабораторной работы вам предстоит создать топологию сети и настроить базовые параметры для узлов ПК и коммутаторов.

**Шаг 1. Создание схемы адресации**

Подсеть сети 192.168.1.0/24 в соответствии со следующими требованиями:

1.  Одна подсеть «Подсеть A», поддерживающая 58 хостов (клиентская VLAN на R1).

    Подсеть A

    Запишите первый IP-адрес в таблице адресации для R1 G0/0/1.100.

    **Введите ваш ответ здесь.**

    Запишите второй IP-адрес в таблице адресов для S1 VLAN 200 и введите соответствующий шлюз по умолчанию.

    **Введите ваш ответ здесь.**

2.  Одна подсеть «Подсеть B», поддерживающая 28 хостов (управляющая VLAN на R1).

    Подсеть B:

    Запишите первый IP-адрес в таблице адресации для R1 G0/0/1.200.

    **Введите ваш ответ здесь.**

    Запишите второй IP-адрес в таблице адресов для S1 VLAN 1 и введите соответствующий шлюз по умолчанию.

    **Введите ваш ответ здесь.**

3.  Одна подсеть «Подсеть C», поддерживающая 12 узлов (клиентская сеть на R2).

    Подсеть C:

    Запишите первый IP-адрес в таблице адресации для R2 G0/0/1.

    **Введите ваш ответ здесь.**

**Шаг 2. Создайте сеть согласно топологии.**

Подключите устройства, как показано в топологии, и подсоедините необходимые кабели.

**Шаг 3. Произведите базовую настройку маршрутизаторов.**

1.  Назначьте маршрутизатору имя устройства.
2.  Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.
3.  Назначьте **class** в качестве зашифрованного пароля привилегированного режима EXEC.
4.  Назначьте **cisco** в качестве пароля консоли и включите вход в систему по паролю.
5.  Назначьте **cisco** в качестве пароля VTY и включите вход в систему по паролю.
6.  Зашифруйте открытые пароли.
7.  Создайте баннер с предупреждением о запрете несанкционированного доступа к устройству.
8.  Сохраните текущую конфигурацию в файл загрузочной конфигурации.
9.  Установите часы на маршрутизаторе на сегодняшнее время и дату.

    **Примечание.** Вопросительный знак (**?**) позволяет открыть справку с правильной последовательностью параметров, необходимых для выполнения этой команды.

**Шаг 4. Настройка маршрутизации между сетями VLAN на маршрутизаторе R1**

1.  Активируйте интерфейс G0/0/1 на маршрутизаторе.
2.  Настройте подинтерфейсы для каждой VLAN в соответствии с требованиями таблицы IP-адресации. Все субинтерфейсы используют инкапсуляцию 802.1Q и им назначается первый полезный адрес из вычисленного пула IP-адресов. Убедитесь, что подинтерфейсу для native VLAN не назначен IP-адрес. Включите описание для каждого подинтерфейса.
3.  Убедитесь, что вспомогательные интерфейсы работают.

**Шаг 5. Настройте G0/1 на R2, затем G0/0/0 и статическую маршрутизацию для обоих маршрутизаторов**

1.  Настройте G0/0/1 на R2 с первым IP-адресом подсети C, рассчитанным ранее.
2.  Настройте интерфейс G0/0/0 для каждого маршрутизатора на основе приведенной выше таблицы IP-адресации.
3.  Настройте маршрут по умолчанию на каждом маршрутизаторе, указываемом на IP-адрес G0/0/0 на другом маршрутизаторе.
4.  Убедитесь, что статическая маршрутизация работает с помощью пинга до адреса G0/0/1 R2 от R1.
5.  Сохраните текущую конфигурацию в файл загрузочной конфигурации.

**Шаг 6. Настройте базовые параметры каждого коммутатора.**

1.  Присвойте коммутатору имя устройства.
2.  Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.
3.  Назначьте **class** в качестве зашифрованного пароля привилегированного режима EXEC.
4.  Назначьте **cisco** в качестве пароля консоли и включите вход в систему по паролю.
5.  Назначьте **cisco** в качестве пароля VTY и включите вход в систему по паролю.
6.  Зашифруйте открытые пароли.
7.  Создайте баннер с предупреждением о запрете несанкционированного доступа к устройству.
8.  Сохраните текущую конфигурацию в файл загрузочной конфигурации.
9.  Установите часы на маршрутизаторе на сегодняшнее время и дату.

    **Примечание.** Вопросительный знак (**?**) позволяет открыть справку с правильной последовательностью параметров, необходимых для выполнения этой команды.

10. Скопируйте текущую конфигурацию в файл загрузочной конфигурации.

**Шаг 7. Создайте сети VLAN на коммутаторе S1.**

**Примечание**. S2 настроен только с базовыми настройками.

1.  Создайте необходимые VLAN на коммутаторе 1 и присвойте им имена из приведенной выше таблицы.
2.  Настройте и активируйте интерфейс управления на S1 (VLAN 200), используя второй IP-адрес из подсети, рассчитанный ранее. Кроме того установите шлюз по умолчанию на S1.
3.  Настройте и активируйте интерфейс управления на S2 (VLAN 1), используя второй IP-адрес из подсети, рассчитанный ранее. Кроме того, установите шлюз по умолчанию на S2
4.  Назначьте все неиспользуемые порты S1 VLAN Parking_Lot, настройте их для статического режима доступа и административно деактивируйте их. На S2 административно деактивируйте все неиспользуемые порты.

    **Примечание.** Команда interface range полезна для выполнения этой задачи с минимальным количеством команд.

**Шаг 8. Назначьте сети VLAN соответствующим интерфейсам коммутатора.**

1.  Назначьте используемые порты соответствующей VLAN (указанной в таблице VLAN выше) и настройте их для режима статического доступа.
2.  Убедитесь, что VLAN назначены на правильные интерфейсы.

Вопрос:

Почему интерфейс F0/5 указан в VLAN 1?

**Введите ваш ответ здесь.**

**Шаг 9. Вручную настройте интерфейс S1 F0/5 в качестве транка 802.1Q.**

1.  Измените режим порта коммутатора, чтобы принудительно создать магистральный канал.
2.  В рамках конфигурации транка установите для native VLAN значение 1000.
3.  В качестве другой части конфигурации магистрали укажите, что VLAN 100, 200 и 1000 могут проходить по транку.
4.  Сохраните текущую конфигурацию в файл загрузочной конфигурации.
5.  Проверьте состояние транка.

Вопрос:

Какой IP-адрес был бы у ПК, если бы он был подключен к сети с помощью DHCP?

**Введите ваш ответ здесь.**

### Часть 2. Настройка и проверка двух серверов DHCPv4 на R1

В части 2 необходимо настроить и проверить сервер DHCPv4 на R1. Сервер DHCPv4 будет обслуживать две подсети, подсеть A и подсеть C.

**Шаг 1. Настройте R1 с пулами DHCPv4 для двух поддерживаемых подсетей. Ниже приведен только пул DHCP для подсети A**

1.  Исключите первые пять используемых адресов из каждого пула адресов.
2.  Создайте пул DHCP (используйте уникальное имя для каждого пула).
3.  Укажите сеть, поддерживающую этот DHCP-сервер.
4.  В качестве имени домена укажите CCNA-lab.com.
5.  Настройте соответствующий шлюз по умолчанию для каждого пула DHCP.
6.  Настройте время аренды на 2 дня 12 часов и 30 минут.
7.  Затем настройте второй пул DHCPv4, используя имя пула R2_Client_LAN и вычислите сеть, маршрутизатор по умолчанию, и используйте то же имя домена и время аренды, что и предыдущий пул DHCP.

**Шаг 2. Сохраните конфигурацию.**

Сохраните текущую конфигурацию в файл загрузочной конфигурации.

**Шаг 3. Проверка конфигурации сервера DHCPv4**

1.  Чтобы просмотреть сведения о пуле, выполните команду `show ip dhcp pool`.
2.  Выполните команду `show ip dhcp bindings` для проверки установленных назначений адресов DHCP.
3.  Выполните команду `show ip dhcp server statistics` для проверки сообщений DHCP.

**Шаг 4. Попытка получить IP-адрес от DHCP на PC-A**

1.  Из командной строки компьютера PC-A выполните команду `ipconfig /all`.
2.  После завершения процесса обновления выполните команду `ipconfig` для просмотра новой информации об IP-адресе.
3.  Проверьте подключение с помощью пинга IP-адреса интерфейса R0 G0/0/1.

### Часть 3. Настройка и проверка DHCP-ретрансляции на R2

В части 3 настраивается R2 для ретрансляции DHCP-запросов из локальной сети на интерфейсе G0/0/1 на DHCP-сервер (R1).

**Шаг 1. Настройка R2 в качестве агента DHCP-ретрансляции для локальной сети на G0/0/1**

1.  Настройте команду `ip helper-address `на G0/0/1, указав IP-адрес G0/0/0 R1.
2.  Сохраните конфигурацию.

**Шаг 2. Попытка получить IP-адрес от DHCP на PC-B**

1.  Из командной строки компьютера PC-B выполните команду `ipconfig /all`.
2.  После завершения процесса обновления выполните команду `ipconfig` для просмотра новой информации об IP-адресе.
3.  Проверьте подключение с помощью пинга IP-адреса интерфейса R1 G0/0/1.
4.  Выполните `show ip dhcp binding` для R1 для проверки назначений адресов в DHCP.
5.  Выполните команду `show ip dhcp server statistics` для проверки сообщений DHCP.
