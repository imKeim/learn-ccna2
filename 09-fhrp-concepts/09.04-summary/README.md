<!-- 9.3.1 -->
## Протокол резервирования первого перехода (FHRP)

В случае сбоя роутера или его интерфейса, выступающего в качестве шлюза по умолчанию, узел, для которого настроено использование этого шлюза, изолируется от внешних сетей. Требуется механизм для предоставления альтернативных шлюзов по умолчанию в коммутируемых сетях, где два или более роутеров подключены к одним и тем же VLAN. Один из способов устранения единой точки отказа на шлюзе по умолчанию — **реализация виртуального роутера**.

С виртуальным роутером несколько устройств настроены для совместной работы, чтобы представить хостам в локальной сети иллюзию одного. В случае сбоя активного роутера протокол резервирования переводит резервный на новые функции активного. Происходит следующее:

1. резервный роутер перестает видеть сообщения приветствия от пересылающего;
2. он принимает на себя роль передающего устройства;
3. новый пересылающий роутер использует IPv4 и MAC-адрес виртуального, поэтому хост-устройства не замечают перебоев в обслуживании.

Использования конкретного протокола в значительной степени зависит от оборудования и потребностей сети. Существуют различные варианты реализации FHRP:

* HSRP и HSRP для IPv6;
* VRRPv2 и VRRPv3;
* GLBP и GLBP для IPv6;
* IRDP.

## HSRP

Проприетарный протокол Cisco — **FHRP**, предназначенный для обеспечения сквозного переключения IPv4-устройства первого перехода. **HSRP** используется группой роутеров для выбора активного и резервного устройств. В рамках группы интерфейсов устройства активным называется то, которое используется для маршрутизации пакетов, резервным — то, которое задействуется в случае сбоя активногоили при выполнении предварительно заданных условий. 

Задача резервного роутера HSRP заключается в мониторинге рабочего состояния группы HSRP и быстром переходе к выполнению функций пересылки пакетов в случае сбоя активного. Устройство с наивысшим приоритетом HSRP станет активным.

**Приоритетное вытеснение** (preemption) — это способность роутера HSRP запускать процесс повторного выбора. Если приоритетное вытеснение включено, при появлении в сети устройства с более высоким приоритетом HSRP оно становится активным. Состояния HSRP включают начальные, обучающие, прослушивающие, говорящие и резервные.

<!-- 9.3.2 -->
<!-- quiz -->
