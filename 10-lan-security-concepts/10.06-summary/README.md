<!-- 10.6.1 -->

## Безопасность оконечных устройств

Оконечные устройства особенно восприимчивы к атакам, связанным с вредоносными программами, которые исходят из электронной почты или просмотра веб-страниц. Таким, как DDOS, утечки данных и вредоносные программы. На этих конечных точках обычно использовались традиционные функции безопасности на уровне хоста, например, антивирусное ПО, брандмауэры на базе хоста и системы предотвращения вторжений на базе хоста (HIPS). Однако сегодня конечные точки лучше всего защищены комбинацией NAC, программного обеспечения AMP на основе хоста, устройств защиты электронной почты (ESA) и устройств веб-безопасности (WSA). WSA может выполнять внесение в черный список URL-адресов, их фильтрацию, сканирование на наличие вредоносных программ, категоризацию URL-адресов, фильтрацию веб-приложений, а также шифрование и дешифрование трафика.

## Контроль доступа

ААА позволяет контролировать, какие пользователи имеют право доступа к сети (аутентификация), какие действия они могут выполнять, находясь в сети (авторизация), а также следить за их действиями во время доступа к сети (учет). При авторизации используется набор атрибутов, описывающий доступ пользователя к сетевой инфраструктуре. Учет широко используется в сочетании с аутентификацией AAA. Серверы AAA хранят журналы с подробной информацией о том, какие действия прошедший аутентификацию пользователь выполнял на данном устройстве. Стандарт IEEE 802.1X определяет контроль доступа на основе портов и протокол аутентификации, который ограничивает для неавторизованных рабочих станций возможность подключаться к локальной сети через общедоступные порты коммутатора.

## Угрозы безопасности на уровне коммутации

Нарушение системы безопасности на уровне 2 также повлияет и на все уровни выше. Первый шаг, который необходимо сделать, чтобы предотвратить атаки на инфраструктуру этого ровня, заключается в том, чтобы понять основные функции уровня 2 и решений защиты на нем: безопасность порта, DHCP-snooping, DAI и IPSG. Они не будут работать, если протоколы управления не защищены.

## Атака на таблицу MAC-адресов

Атаки переполнением таблицы MAC-адресов отправляет фиктивные MAC-адреса, до тех пор, пока таблица коммутатора не заполнится. В этот момент, коммутатор обрабатывает кадр как неизвестную одноадресную рассылку и начинает пересылать весь входящий трафик из всех портов в той же VLAN без учета таблицы MAC. Это условие позволяет атакующему захватить все кадры, отправленные с одного хоста на другой в локальной сети или VLAN. Исполнитель угрозы подключен к VLAN 10 и использует **macof** для быстрой генерации множества случайных MAC-адресов источника и назначения и IP-адресов. Чтобы нейтрализовать атаки переполнения таблицы MAC-адресов, сетевые администраторы должны реализовать защиту портов (Port security).

## Атаки на локальную сеть

VLAN hopping позволяет видеть трафик из одной VLAN в другой без помощи роутера. Атакующий настраивает узел так, чтобы он действовал как коммутатор, чтобы использовать функцию автоматического согласования магистрального порта, включенную по умолчанию на большинстве портов коммутатора.

Этот вид атаки является однонаправленным и работает, только если злоумышленник подключен к порту, находящемуся в той же VLAN, что и сеть Native VLAN транкового порта. Двойная маркировка позволяет злоумышленнику отправлять данные на хосты или серверы в VLAN, которые в противном случае были бы заблокированы каким-либо типом конфигурации контроля доступа. Обратный трафик также будет разрешен, что дает злоумышленнику возможность общаться с устройствами в нормально заблокированной VLAN.

Атаки VLAN hopping и двойной маркировкой VLAN могут быть предотвращены путем реализации следующих рекомендаций по безопасности магистральных каналов:

* отключить транкинг на всех портах доступа;
* отключить автоматический транкинг на магистральных каналах, чтобы транки включались только вручную;
* убедиться, что Native VLAN используется только для магистральных каналов.

**Атаки DHCP**

Серверы DHCP динамически предоставляют клиентам сведения о конфигурации IP, включая IP-адрес, маску подсети, шлюз по умолчанию, DNS-серверы и так далее. Два типа атак DHCP – это истощение DHCP и DHCP-spoofing. Обе атаки нейтрализуются за счет реализации DHCP-snooping.

**ARP атака**

Злоумышленник может отправить коммутатору сообщение **gratuitous ARP**, содержащее поддельный MAC-адрес, и коммутатор соответствующим образом обновит свою таблицу MAC-адресов. Теперь злоумышленник может отправлять незапрошенные ответы ARP другим узлам в подсети с MAC-адресом субъекта угрозы и IP-адресом шлюза по умолчанию. Атаки ARP-спуфинга (атаки подмены) и «отравление» ARP-кэша нейтрализуются путем внедрения DAI.

**Атака подмены адреса**

**Подмена IP-адреса** – это действие, когда злоумышленник перехватывает действительный IP-адрес другого устройства в подсети или использует случайный IP-адрес. Злоумышленники изменяют MAC-адрес своего хоста в соответствии с другим известным адресом целевого хоста. Атаки подмены IP и MAC-адресов может быть уменьшена путем внедрения IPSG.

**STP-атака**

Сетевые злоумышленники могут манипулировать протоколом связующего дерева (STP) для проведения атаки путем подмены корневого моста и изменения топологии сети. Они могут сделать так, чтобы их хосты выглядели как корневые мосты, и в результате перехватить весь трафик ближайшего коммутируемого домена. Эта STP-атака нейтрализуется за счет реализации BPDU Guard на всех портах доступа.

**Разведывательная атака CDP**

Информация протокола CDP отправляется через порты с поддержкой CDP в периодических незашифрованных широковещательных рассылках. Данные протокола CDP включают IP-адрес устройства, версию ОС IOS, а также сведения о платформе, возможностях и VLAN с нетегированным трафиком. Однако информацией протокола CDP может также воспользоваться и злоумышленник, который ищет слабые места в сетевой инфраструктуре. Чтобы минимизировать вероятность использования CDP злоумышленниками, ограничьте использование протокола CDP на устройствах или портах.

<!-- 10.6.2 -->
<!-- quiz -->
