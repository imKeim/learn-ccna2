<!-- 11.2.1 -->
## Обзор атак VLAN

В качестве краткого обзора, атака с переходом VLAN может быть запущена одним из трех способов.

* **Подмена сообщений DTP** от атакующего хоста, чтобы заставить коммутатор войти в режим транкинга. Отсюда злоумышленник может отправлять трафик, помеченный целевой VLAN, а коммутатор затем доставляет пакеты в пункт назначения.
* **Вводится вредоносный коммутатор** и включается транкинг. Затем хакер может получить доступ ко всем VLAN на коммутаторе-жертве с вредоносного коммутатора.
* Другим типом атаки со переходом VLAN является **атака с двойным тегированием** (или двойной инкапсуляцией). Она использует преимущества аппаратного обеспечения большинства коммутаторов.

<!-- 11.2.2 -->
## Нейтрализация атаки VLAN-hopping

Используйте следующие шаги, чтобы нейтрализовать атаки с переходом VLAN.

**Шаг 1.** Отключите согласование DTP (автоматические магистральные каналы) на немагистральных портах с помощью команды интерфейсной настройки **switchport mode access**.

**Шаг 2.** Отключите неиспользуемые порты и назначьте их неиспользуемой VLAN.

**Шаг 3.** Вручную включите магистральный канал на порту с помощью команды интерфейсной настройки **switchport mode trunk**.

**Шаг 4.** Отключите согласование DTP (автоматические магистральные каналы) на магистральных портах с помощью команды интерфейсной настройки **switchport nonegotiate**.

**Шаг 5.**: Установите для Native VLAN, отличную от VLAN 1, с помощью команды **switchport trunk native vlan _vlan\_number_**.

Например, предположим следующее:

* порты FastEthernet с 0/1 по fa0/16 являются активными портами доступа;
* порты FastEthernet с 0/17 по 0/20 в настоящее время не используются;
* порты FastEthernet с 0/21 по 0/24 являются магистральными портами.

 VLAN-hopping может быть нейтрализован путем реализации следующей конфигурации:

```
S1(config)# interface range fa0/1 - 16
S1(config-if-range)# switchport mode access
S1(config-if-range)# exit
S1(config)# 
S1(config)# interface range fa0/17 - 20
S1(config-if-range)# switchport mode access
S1(config-if-range)# switchport access vlan 1000
S1(config-if-range)# shutdown
S1(config-if-range)# exit
S1(config)# 
S1(config)# interface range fa0/21 - 24
S1(config-if-range)# switchport mode trunk
S1(config-if-range)# switchport nonegotiate
S1(config-if-range)# switchport trunk native vlan 999
S1(config-if-range)# end
S1#
```

* Порты FastEthernet от 0/1 до 0/16 являются портами доступа, поэтому транкинг отключен, явно сделав их портами доступа.
* Порты FastEthernet с 0/17 по 0/20 являются неиспользуемыми портами и отключены и назначены неиспользуемой VLAN.
* Порты FastEthernet с 0/21 по 0/24 являются магистральными и включаются вручную как транки с отключенным DTP. Native VLAN также изменяется с VLAN 1 (по умолчанию) на неиспользуемую VLAN 999.

<!-- 11.2.3 -->
<!-- syntax -->
