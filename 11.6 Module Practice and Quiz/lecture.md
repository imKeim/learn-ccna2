# Практика и контрольная работа модуля

<!-- 11.6.1-->
## Packet Tracer - Конфигурация безопасности коммутатора

В этом упражнении Packet Tracer вам нужно:

- Обеспечить безопасность неиспользуемых портов.
- Настроить параметры безопасности портов.
- Нейтрализовать атаки VLAN Hopping
- Обеспечить отражение атак через DHCP
- Обеспечить отражение атак через ARP
- Обеспечить отражение атак через STP
- Проверить конфигурации безопасности коммутатора

[Открыть описание в PDF](./assets/11.6.1-packet-tracer---switch-security-configuration_ru-RU.pdf)

[Скачать файл для Packet Tracer](./assets/11.6.1-packet-tracer---switch-security-configuration_ru-RU.pka)

<!-- 11.6.2-->
## Лабораторная работа - Конфигурация безопасности коммутатора

В этой лабораторной работе вам предстоит:

- Обеспечивать безопасность неиспользуемых портов.
- Настроить параметры безопасности портов.
- Нейтрализовать атаки VLAN Hopping
- Обеспечить отражение атак через DHCP
- Обеспечить отражение атак через ARP
- Обеспечить отражение атак через STP
- Проверить конфигурации безопасности коммутатора

[Открыть описание в PDF](./assets/11.6.2-lab---switch-security-configuration_ru-RU.pdf)

<!-- 11.6.3-->
## Что я изучил в этом модуле?

Перед введением коммутатора в эксплуатацию необходимо обеспечить безопасность всех портов (интерфейсов) коммутатора. Самый простой и эффективный метод предотвращения атак переполнения таблицы MAC-адресов — это обеспечение безопасности порта. По умолчанию порты коммутатора уровня 2 настроены на динамический автоматический режим (транкинг включен). Коммутатор может быть настроен на изучение MAC-адресов на защищенном порту одним из трех способов: настраивается вручную, динамически запоминается и динамически запоминается - sticky. Устаревание безопасности порта может использоваться для установки времени устаревания статических и динамических защищенных адресов на порту. Для каждого порта поддерживается два типа старения: абсолютный и по времени неактивности. Если MAC-адрес устройства, подключенного к порту, отличается от списка защищенных адресов, происходит нарушение (violation) порта. По умолчанию порт переходит в состояние отключения по ошибке (error-disabled). Когда порт отключен и переведен в состояние error-disabled, трафик на этот порт не отправляется и не принимается. Для отображения параметров безопасности портов для коммутатора или заданного интерфейса воспользуйтесь командой **show port-security**.

Чтобы нейтрализовать атаки VLAN Hopping

**Шаг 1**. Отключите согласование DTP на немагистральных портах.
**Шаг 2**. Отключение неиспользуемых портов.
**Шаг 3**. Вкручную включите транкинг на магистральном порту.
**Шаг 4**. Отключите согласование DTP на магистральных портах.
**Шаг 5**. SetУстановите для собственную VLAN, отличную от VLAN 1.

Цель атаки с истощение DHCP - создать отказ в обслуживании (DoS) для подключения клиентов. Атаки DHCP-спуфинга можно предотвратить, используя анализ DHCP-трафика на доверенных портах. DHCP Snooping определяет, является ли DHCP сообщение от административно сконфигурированных доверенного или ненадежного источника. Затем он фильтрует сообщения DHCP и объем DHCP трафика из ненадежных источников. Чтобы включить отслеживание DHCP, выполните следующие действия:

**Шаг 1**. Включить отслеживание DHCP
**Шаг 2**. На доверенных портах используйте команду настройки интерфейса ip dhcp snooping trust.
**Шаг 3**. Ограничьте количество сообщений обнаружения DHCP, которые могут быть получены в секунду на ненадежных портах.
**Шаг 4**. Включите отслеживание DHCP для VLAN или для диапазона VLAN.

Динамическая проверка ARP (DAI) требует отслеживания DHCP и помогает предотвратить атаки ARP путем:

Не ретранслирует недопустимые или незапрошенные ответы ARP на другие порты в той же VLAN.
Перехват всех ARP-запросов и ответов на ненадежных портах.
Проверка каждого перехваченного пакета на предмет правильной привязки IP-к-MAC.
Удаление и регистрация ARP Ответы, поступающие из недействительных, чтобы предотвратить отравление ARP.
Ошибка отключения интерфейса, если настроенное число DAI пакетов ARP превышено.
Чтобы снизить вероятность подделки ARP и отравления ARP, выполните следующие рекомендации по внедрению DAI:

Включить отслеживание DHCP на глобальном уровне.
Включите отслеживание DHCP на выбранных VLAN.
Включить DAI на выбранных VLAN.
Настройте доверенные интерфейсы для отслеживания DHCP и проверки ARP.
Рекомендуется настроить все порты коммутатора доступа как ненадежные и настроить все порты связывающие с вышестоящими устройствами, как доверенные.

DAI также можно настроить для проверки MAC-адресов и IP-адресов назначения или источника:

**Destination MAC**- Проверяет MAC-адрес назначения в заголовке Ethernet по отношению к целевому MAC-адресу в теле ARP.
**Source MAC** - Проверяет MAC-адрес источника в заголовке Ethernet на соответствие MAC-адреса отправителя в теле ARP.
**IP address** - Проверяет тело ARP на наличие недопустимых и неожиданных IP-адресов, включая адреса 0.0.0.0, 255.255.255.255 и все IP-адреса многоадресной рассылки.
Чтобы нейтрализовать атаки манипуляций с протоколом STP, используйте средства защиты PortFast и Bridge Protocol Data Unit (BPDU):

**PortFast** - PortFast немедленно переводит интерфейс, настроенный как порт доступа или магистральный порт, в состояние пересылки из состояния блокировки, минуя состояния прослушивания и обучения. Применить ко всем портам конечного пользователя. PortFast следует настраивать только на портах, подключенных к конечным устройствам. PortFast обходит состояния прослушивания и обучения STP, чтобы минимизировать время, в течение которого порты доступа должны ожидать конвергенции STP. Если PortFast включен на порту, подключенном к другому коммутатору, существует риск создания цикла связующего дерева.
**BPDU Guard** - защита BPDU немедленно при ошибке отключает порт, который получает BPDU. Как и PortFast, защита BPDU должна быть настроена только на интерфейсах, подключенных к конечным устройствам. BPDU Guard можно включить в порту с помощью команды spanning-tree bpduguard enable. Либо используйте команду глобальной конфигурации spanning-tree portfast bpduguard default, чтобы глобально включить защиту BPDU на всех портах с включенной PortFast.