<!-- 3.6.3 -->
## Обзор виртуальной локальной сети

Группа устройств в сети VLAN взаимодействует так, будто устройства подключены с помощью одного кабеля. Сети VLAN основываются не на физических, а на логических подключениях. Администраторы используют VLAN для сегментации сетей на основе таких факторов, как функция, команда или приложение. Каждая VLAN считается отдельной логической сетью. Любой коммутационный порт может принадлежать сети VLAN.

VLAN создает логический домен широковещательной рассылки, который может охватывать несколько физических сегментов LAN. Разделяя крупные широковещательные домены на более мелкие сети, VLAN повышают производительность сети. Каждая VLAN в коммутируемой сети соответствует IP-сети; поэтому при проектировании VLAN должна использоваться иерархическая схема сетевой адресации. Типы VLAN включают VLAN по умолчанию, VLAN данных, собственную VLAN, управляющие VLAN и голосовые VLAN.

## Виртуальные локальные сети в среде с несколькими коммутаторами

Транк VLAN не принадлежит определенной VLAN. Это канал для нескольких VLAN между коммутаторами и маршрутизаторами. Магистраль сетей VLAN (транк) — это двухточечный канал связи, который обслуживает более одной сети VLAN. Транк VLAN расширяет сети VLAN по всей сети. Когда VLAN реализованы на коммутаторе, передача одноадресного, многоадресного и широковещательного трафика от хоста в конкретной VLAN ограничивается устройствами, которые находятся в этой VLAN.

Поля тегов VLAN включают тип, приоритет пользователя, CFI и VID. Некоторые устройства, поддерживающие транкинг, добавляют тег VLAN в пакеты VLAN с нетегированным трафиком. Если магистральный порт 802.1Q получает тегированный кадр с таким же идентификатором VLAN, как у сети VLAN с нетегированным трафиком, то он отбрасывает этот кадр. Для поддержки передачи голоса по IP (VoIP) требуется отдельная голосовая сеть VLAN. К голосовому трафику могут применяться политики QoS и безопасности. Трафик голосовой VLAN должен быть помечен соответствующим значением приоритета CoS уровня 2.

## Настройка VLAN

Различные коммутаторы Cisco Catalyst поддерживают различные количества VLAN, включая VLAN нормального диапазона и VLAN расширенного диапазона. При настройке сетей VLAN стандартного диапазона сведения о конфигурации хранятся во флеш-памяти коммутатора, в файле vlan.dat. Хотя это не требуется, рекомендуется сохранить текущие изменения конфигурации в конфигурации запуска. Следующий шаг после создания сети VLAN — назначение портов сетям VLAN. 

Сети VLAN настраиваются на коммутационном порту, а не на устройстве. Порт доступа может принадлежать только одной VLAN. Однако порт также может быть связан с голосовой VLAN. Например, порт, подключенный к IP-телефону и конечному устройству, будет связан с двумя VLAN: одной для голосовой связи и другой для данных. После настройки сети VLAN ее конфигурации можно проверить с помощью команд Cisco IOS категории «**show**».

Если на порт доступа коммутатора неправильно назначен VLAN, просто повторно введите команду конфигурации интерфейса **switchport access vlan** _vlan-id_ с правильным идентификатором VLAN. Команда **no vlan** _vlan-id_ режима глобальной конфигурации используется для удаления VLAN из файла коммутатора vlan.dat.

## Транки виртуальных сетей

Канал VLAN — это канал OSI уровня 2 между двумя коммутаторами, который передает трафик для всех VLAN. Существует несколько команд для настройки взаимосвязанных портов. Для проверки конфигурации магистрали VLAN используйте команду **show interfaces** _interface-ID_ **switchport**. Используйте команды **no switchport trunk allowed vlan** и **no switchport trunk native vlan** для удаления разрешенных VLAN и сброса собственной VLAN магистрали.

## Динамический протокол транкинга (DTP)

Интерфейс может быть переведен в магистральный режим или режим без магистрали, либо настроен для согласования такого режима с соседним интерфейсом. Согласование магистрали управляется динамическим протоколом магистральных каналов (DTP), который действует по принципу подключения «точка-точка» между сетевыми устройствами. DTP является проприетарным протоколом Cisco, который управляет согласованием транков, только если порт на соседнем коммутаторе настроен в режиме транка, который поддерживает DTP. 

Чтобы включить транкинг от коммутатора Cisco к устройству, не поддерживающему DTP, используйте команды режима настройки интерфейса **switchport mode trunk** и **switchport nonegotiate**. Команда **switchport mode** имеет дополнительные опции для согласования режима интерфейса, включая доступ, динамический автоматический, динамический желательный и магистральный. Чтобы проверить текущий режим DTP, выполните команду **show dtp interface**.

<!-- 3.6.4 -->
<!-- quiz -->