<!-- 7.4.3 -->

## Принципы DHCPv4

Сервер DHCPv4 динамически назначает или арендует IPv4-адрес клиенту из пула адресов на ограниченный период времени, выбранный сервером, или до тех пор, пока клиент больше не будет нуждаться в адресе. Процесс аренды DHCPv4 начинается с отправки клиентом сообщения с запросом служб DHCP-сервера.

Если сервер DHCPv4 получает сообщение, он будет отвечать IPv4 адрес и возможные другие сведения о конфигурации сети. Периодически клиент должен связываться с DHCP-сервером для продления срока аренды. Благодаря подобному механизму «переехавшие» или отключившиеся клиенты не занимают адреса, в которых они больше не нуждаются.

Когда клиент загружается (или иным образом хочет присоединиться к сети), он начинает четырехэтапный процесс для получения аренды: DHCPDISCOVER, затем DHCPOFFER, затем DHCPREQUEST и, наконец, DHCPACK. До истечения срока аренды клиент начинает двухэтапный процесс продления аренды с сервером DHCPv4: DHCPREQUEST затем DHCPACK.

## Настройка сервера DHCPv4 в Cisco IOS

Маршрутизатор Cisco под управлением ОС Cisco IOS можно настроить в качестве DHCPv4-сервера. Для настройки сервера DHCPv4 Cisco IOS выполните следующие действия: исключите адреса IPv4, определите имя пула DHCPv4 и настройте пул DHCPv4. Проверьте конфигурацию с помощью команд **show running-config | section dhcp**, **show ip dhcp binding** и **show ip dhcp server statistics**.

Служба DHCPv4 включена по умолчанию. Для того чтобы отключить службу, введите команду в режиме глобальной конфигурации **no service dhcp**.

В сложной иерархической сети корпоративные серверы обычно располагаются в серверной ферме. Данные серверы могут предоставлять службы DHCP, DNS, TFTP и FTP. Клиенты сети и серверы, как правило, находятся в разных подсетях. Для определения местоположения серверов и получения услуг клиенты часто используют сообщения широковещательной рассылки. Если DHCP-сервер находится в отдельной сети, необходимо настроить пересылку таких широковещательных пакетов с помощью команды конфигурации **ip helper-address** _address interface_.

Администратор сети может использовать эту команду **show ip interface** для проверки конфигурации. По умолчанию команда **ip helper-address** переадресовывает следующие восемь служб UDP:

* Port 37: Время
* Port 49: TACACS
* Port 53: DNS
* Port 67: DHCP/BOOTP server
* Port 68: DHCP/BOOTP client
* Port 69: TFTP
* Port 137: NetBIOS name service
* Port 138: NetBIOS datagram service

## Настройка клиента DHCPv4

В простейшей конфигурации для соединения с кабельным или DSL-модемом используется Ethernet-интерфейс. Для настройки Ethernet-интерфейса в качестве DHCP-клиента используйте команду режима настройки интерфейса **ip address dhcp interface**. Маршрутизаторы беспроводной связи настраиваются для автоматического получения адресов IPv4 от интернет-провайдера. Тип интернет-соединения установлен на Автоматическая настройка - DHCP. Этот параметр используется, когда маршрутизатор подключен к кабельному или DSL-модему и выступает в качестве DHCPv4-клиента, запрашивая IPv4-адрес у интернет-провайдера.

<!-- 7.4.4 -->
<!-- quiz -->